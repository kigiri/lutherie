(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}})();const x=(t,e,n="")=>({type:"point",x:t,y:e,label:n}),g=(t,e)=>x(e.x,e.y,t),v=(t,e)=>({type:"line",p1:t,p2:e}),$=(t,e)=>({type:"circle",center:t,radius:e}),tt=(t,e,n)=>({type:"curve",start:t,finish:e,objects:n}),Ct=t=>t&&t.type==="point",B=t=>t&&t.type==="line",E=t=>t&&t.type==="circle",Mt=t=>t&&t.type==="curve",lt=t=>t*t,z=Math.abs,nt=Math.sqrt,at=Math.round,bt=x(0,0),w=(t,e)=>x(t.x+e,t.y,t.label),Q=(t,e)=>x(t.x,t.y+e,t.label),L=t=>x(-t.x,t.y,t.label?t.label+"'":""),F=(t,e)=>z(t.x-e.x),m=(t,e)=>nt(lt(t.x-e.x)+lt(t.y-e.y)),Lt=t=>t.reduce((e,n)=>e.y<n.y?e:n),Et=t=>t.reduce((e,n)=>e.y>n.y?e:n),N=(t,e)=>{if(!Array.isArray(e))return e;if(e.length===0)throw new Error("closest: empty list");return e.length===1?e[0]:e.reduce((n,r)=>m(t,r)<m(t,n)?r:n)},A=t=>{if(t.p2.x-t.p1.x===0)return 1/0;const e=(t.p2.y-t.p1.y)/(t.p2.x-t.p1.x);return z(e)>1e4?1/0:e},V=t=>{const e=A(t);if(!Number.isFinite(e))throw new Error("offset: undefined for vertical line");return t.p1.y-e*t.p1.x},O=t=>!Number.isFinite(A(t)),At=t=>{const e=A(t);return Number.isFinite(e)&&z(e)<.001},M=t=>v(t,x(t.x+100,t.y)),b=t=>v(t,x(t.x,t.y+100)),R=(t,e)=>x(t.x,e.y),S=(t,e)=>$(t,m(t,e)),ut=t=>w(t.center,-t.radius),kt=t=>z(t-at(t))<.1?at(t):t,Pt=-.75,It=(t,e,n)=>{let r=kt(e*e-4*t*n);if(r<Pt)throw new Error(`quadsolve: no solutions a=${t} b=${e} c=${n} d=${r}`);r<0&&(r=0);const o=-e;if(r===0)return[o/(2*t)];const s=nt(r);return[(o+s)/(2*t),(o-s)/(2*t)]},mt=(t,e)=>{if(O(t)&&O(e))throw new Error("intersect-line-line: both vertical");if(O(t))return mt(e,t);if(O(e)){const c=A(t),u=V(t),i=e.p1.x;return x(i,c*i+u)}const n=A(t),r=A(e),o=V(t),s=V(e);if(n===r&&o===s)throw new Error("intersect-line-line: identical lines");if(n===r)throw new Error("intersect-line-line: parallel lines");return x((s-o)/(n-r),(r*o-n*s)/(r-n))},_=(t,e)=>{const{x:n,y:r}=t.center,o=t.radius;if(O(e)){const f=e.p1.x,y=z(f-n);if(y>o+.001)return[];const h=nt(Math.max(0,o*o-y*y));return[x(f,r+h),x(f,r-h)]}const s=A(e),c=V(e),u=1+s*s,i=2*(s*(c-r)-n),l=n*n+(c-r)*(c-r)-o*o;return It(u,i,l).map(f=>x(f,s*f+c)).sort((f,y)=>f.x-y.x)},Rt=(t,e)=>{const{x:n,y:r}=t.center,o=t.radius,{x:s,y:c}=e.center,u=e.radius;if(r===c){const y=(o*o-u*u-(n*n-s*s))/(2*(s-n));return b(x(y,0))}const i=o*o-u*u-n*n+s*s-r*r+c*c,l=s-n,d=c-r,a=x(0,i/(2*d)),f=x(1,(i-2*l)/(2*d));return v(a,f)},ht=(t,e)=>{if(m(t.center,e.center)<1e-5)throw new Error("intersect-circle-circle: Same center");return m(t.center,e.center)>t.radius+e.radius+.001?[]:_(t,Rt(t,e))},T=(t,e)=>{if(E(e)&&!E(t))return T(e,t);if(E(t)){if(E(e))return ht(t,e);if(B(e))return _(t,e)}else if(B(t)){if(B(e))return mt(t,e);if(E(e))return _(e,t)}throw new Error("intersect: not implemented for these types")},k=(t,e)=>{try{const n=T(t,e);return n?Array.isArray(n)?n:[n]:[]}catch{return[]}},H=(t,e,n)=>x(t.x+n*(e.x-t.x),t.y+n*(e.y-t.y)),dt=(t,e)=>{if(O(t))return M(e);if(At(t))return b(e);const r=-1/A(t),o=e.y-r*e.x;return v(x(0,o),x(1,r+o))},Nt=(t,e,n)=>{const r=v(w(t.p1,n),w(t.p2,n)),o=$(e.center,e.radius-n),s=k(r,o),c=N(Et(s),s);return $(c,n)},Ot=(t,e,n)=>{const r=v(w(t.p1,n),w(t.p2,n)),o=$(e.center,e.radius-n),s=k(r,o),c=N(Lt(s),s);return $(c,n)},Bt=(t,e)=>S(w(ut(t),e),ut(t)),K=(t,e,n)=>{const r=e-t.radius;return k($(n,Math.abs(r)),$(t.center,e)).map(s=>{const c=k(t,v(s,t.center)),u=N(s,c);return $(s,m(s,u))})},Ft=(t,e,n)=>{const r=K(t,t.radius+e,n);if(r.length===0)throw new Error("Lower corner construction failed");return r[0].center.y>r[1].center.y?r[1]:r[0]},St=(t,e,n)=>{const r=K(t,t.radius+e,n);if(r.length===0)throw new Error("Upper corner construction failed");return r[0].center.y>r[1].center.y?r[0]:r[1]},Tt=(t,e,n)=>{const r=K(t,t.radius-e,n);if(r.length===0)throw new Error("Middle top corner failed");return r[0].center.y>r[1].center.y?r[1]:r[0]},qt=(t,e,n)=>{const r=K(t,t.radius-e,n);if(r.length===0)throw new Error("Middle bottom corner failed");return r[0].center.y>r[1].center.y?r[0]:r[1]},zt=()=>{const t=x(0,0),e=208,n=g("X",t),r=g("A",w(n,-104)),o=g("Q",Q(n,e)),s=g("N",H(n,o,1/4)),c=g("q",w(R(r,o),m(n,s)/2)),u=g("q'",L(c)),i=g("O",Q(o,-(m(n,s)*5/4))),l=g("Z",Q(s,m(n,s)*2/3)),d=g("P",Q(n,-(m(n,s)*8/3))),a=g("p",w(R(r,d),m(n,s)/8)),f=g("p'",L(a)),y=g("M",H(n,d,1/2)),h=g("a",w(r,m(n,l)/2)),C=g("b",w(l,-(m(r,h)/2))),p=g("e",w(R(C,s),-(F(C,a)*3/8))),I=g("c",w(R(a,n),F(p,a)/4)),X=g("d",w(R(a,n),F(p,a)/2)),rt=g("h",w(R(p,l),-(F(p,a)/4))),D=g("g",w(R(p,l),-(F(p,a)/2))),U=S(l,d),G=Ot(b(a),U,m(y,d)),J=Bt(G,m(n,l)),st=Ft(J,m(n,s)/2,I),pt=tt(d,I,[U,G,J,st]),W=S(s,o),j=Nt(b(c),W,m(i,o)),ot=St(j,m(n,s)/2,D),$t=tt(o,D,[W,j,ot]),Z=S(w(p,-m(n,l)),p),ct=Tt(Z,m(s,l)/2,rt),it=qt(Z,m(n,s)/2,X),vt=tt(D,I,[ct,Z,it]);return[n,r,o,s,c,u,i,l,d,a,f,y,h,C,p,I,X,rt,D,M(s),M(i),M(l),M(d),M(o),M(n),M(y),b(a),b(c),b(C),b(p),v(a,L(c)),U,G,J,st,W,j,ot,Z,ct,it,pt,vt,$t]},gt=1e3,wt=1750,et=1.5*(1e3/914.4),P=t=>{const e=et*t.x,n=-et*t.y;return{x:e+gt/2,y:n+wt/2}},q=(t,e,n,r,o)=>{const s=P(t),c=P(e);return`<line x1="${s.x}" y1="${s.y}" x2="${c.x}" y2="${c.y}" stroke="${n}" stroke-width="${r}" stroke-linecap="round"  />`},Xt=(t,e)=>{const n=P(t.center),r=et*t.radius;return`<ellipse cx="${n.x}" cy="${n.y}" rx="${r}" ry="${r}" stroke="${e}" stroke-width="1" fill="none" />`},Dt=(t,e,n)=>{const r=P(t);return`<text x="${r.x+4}" y="${r.y-4}" fill="${n}" font-size="12" font-family="monospace">${e}</text>`},Y=(t,e,n,r,o=1.5)=>{const s=P(t),c=P(e),u=P(n),i=m({x:s.x,y:s.y},{x:c.x,y:c.y});if(m(e,n)<1e-4)return"";const l=Math.atan2(c.y-s.y,c.x-s.x);let a=Math.atan2(u.y-s.y,u.x-s.x)-l;for(;a<=-Math.PI;)a+=2*Math.PI;for(;a>Math.PI;)a-=2*Math.PI;const f=0,y=a>0?1:0;return`<path d="M ${c.x} ${c.y} A ${i} ${i} 0 ${f} ${y} ${u.x} ${u.y}" stroke="${r}" stroke-width="${o}" stroke-linecap="round" fill="none" />`},yt=(t,e,n)=>{const r=v(t,e),o=dt(r,t),s=dt(r,e),c=$(t,Math.abs(n.overhang)),u=$(e,Math.abs(n.overhang)),i=k(o,c),l=k(s,u);if(i.length===0||l.length===0)return"";const d=y=>y.length===1?y[0]:t.x<0?y[0].x<y[1].x?y[0]:y[1]:y[0].x>y[1].x?y[0]:y[1],a=d(i),f=d(l);return q(a,f,n.edgeColor,1)},ft=(t,e,n,r,o)=>{let s=Y(t,e,n,r,1.5);const c=S(t,e),u=T(M(t),b(bt)),i=T(c,M(t)),l=Array.isArray(i)?i:[i],d=N(u,l),a=m(t,d)<m(t,u)?-1:1;if(o.tracing){const f=y=>{const h=m(t,y),C=(h+a*o.overhang)/h;return H(t,y,C)};s+=Y(t,f(e),f(n),o.edgeColor,1)}if(o.mirror){const f=L(t),y=L(e),h=L(n);if(s+=Y(f,y,h,r,1.5),o.tracing){const C=p=>{const I=m(f,p),X=(I+a*o.overhang)/I;return H(f,p,X)};s+=Y(f,C(y),C(h),o.edgeColor,1)}}return s},xt=(t,e,n)=>{let r=q(t,e,n.arcColor,1.5);return n.tracing&&(r+=yt(t,e,n)),n.mirror&&(r+=q(L(t),L(e),n.arcColor,1.5),n.tracing&&(r+=yt(L(t),L(e),n))),r},Zt=(t,e)=>{const{start:n,finish:r,objects:o}=t;let s="";const c=(i,l,d)=>{if(d.length===0)return;const a=d[0];if(d.length===1){if(B(a))s+=xt(i,l,e);else if(E(a)){const f=a.center,y=v(f,l),h=k(a,y),C=N(l,h);s+=ft(f,i,C,e.arcColor,e)}}else{const f=d[1],y=k(a,f);if(y.length===0)return;const h=N(i,y);B(a)?s+=xt(i,h,e):E(a)&&(s+=ft(a.center,i,h,e.arcColor,e)),c(h,l,d.slice(1))}};let u=n;if(E(o[0])){const i=v(o[0].center,n),l=k(o[0],i);u=N(n,l)}return c(u,r,o),s},Qt=(t,e)=>{let n="",r="",o="",s="";const c="#b71c1c";for(const i of t)if(Ct(i)){const l=P(i),d=1.5;s+=`<path d="M ${l.x-d} ${l.y-d} L ${l.x+d} ${l.y+d} M ${l.x-d} ${l.y+d} L ${l.x+d} ${l.y-d}" stroke="${c}" stroke-width="0.75" stroke-linecap="round" />`,i.label&&(s+=Dt(i,i.label,c))}else if(B(i)){const l=A(i);if(!Number.isFinite(l)||Math.abs(l)>1e3)r+=q({x:i.p1.x,y:-1e3},{x:i.p1.x,y:1e3},"green",.5);else{const d=a=>i.p1.y+l*(a-i.p1.x);r+=q({x:-500,y:d(-500)},{x:500,y:d(500)},"green",.5)}}else E(i)?n+=Xt(i,"#e0e0e0"):Mt(i)&&(o+=Zt(i,e));const u=n+r+o+s;return`
    <svg viewBox="0 0 ${gt} ${wt}" xmlns="http://www.w3.org/2000/svg" style="background: white; border: 1px solid #ccc;">
        ${u}
    </svg>
    `},Yt=()=>{let t=`Running Tests...
`,e=0,n=0;const r=(c,u)=>{u?e++:(n++,t+=`[FAIL] ${c}
`)},o=(c,u,i=.001)=>Math.abs(c-u)<i,s=(c,u)=>o(c.x,u.x)&&o(c.y,u.y);try{r("Distance",o(m(x(0,0),x(3,4)),5));const c=v(x(0,0),x(10,10)),u=v(x(0,10),x(10,0)),i=T(c,u);r("Line-Line Intersection",!Array.isArray(i)&&i!==null&&s(i,x(5,5)));const l=$(x(0,0),5),d=b(x(3,0)),a=_(l,d);r("Circle-VerticalLine Count",a.length===2),r("Circle-VerticalLine Y1",o(a[0].y,-4)||o(a[0].y,4));const f=$(x(-2,0),3),y=$(x(2,0),3),h=ht(f,y);r("Circle-Circle Count",h.length===2),r("Circle-Circle X",o(h[0].x,0)),r("Circle-Circle Y",o(Math.abs(h[0].y),Math.sqrt(5)))}catch(c){t+=`[FATAL] Exception during tests: ${c}
`,n++}return t+=`
Done. Passed: ${e}, Failed: ${n}`,t};document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("svg-container"),e=document.getElementById("test-results"),n=document.getElementById("btn-draw"),r=document.getElementById("btn-test"),o=document.getElementById("chk-tracing"),s=document.getElementById("chk-mirror");let c=null;const u=()=>{if(!t)return;c&&(c.dispose(),c=null);const l={mirror:s.checked,tracing:o.checked,arcColor:"#002395",edgeColor:"orange",overhang:5},d=zt();t.innerHTML=Qt(d,l);const a=t.querySelector("svg");a&&(a.style.display="block",c=panzoom(a,{maxZoom:10,minZoom:.1,initialZoom:.4,zoomDoubleClickSpeed:1})),e&&(e.style.display="none")},i=()=>{e&&(e.style.display="block",e.textContent=Yt())};n&&n.addEventListener("click",u),r&&r.addEventListener("click",i),u()});
